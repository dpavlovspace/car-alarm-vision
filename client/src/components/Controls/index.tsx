import React, { FC, useEffect } from 'react';
import { useDispatch, useSelector } from 'react-redux';
import { Link } from 'react-router-dom';

import { getSettings, setSettings } from '../../actions/common';
import { Settings } from '../../actions/common.actionTypes';
import { AppState } from '../../store';
import { Control, ControlsContainer } from './styles';

const Controls: FC = () => {
  const dispatch = useDispatch();
  const { settings } = useSelector((state: AppState) => state.common);

  useEffect(() => {
    dispatch(getSettings());
  }, []);

  const updateSettings = (s: Settings) => {
    dispatch(setSettings(s));
  };

  return (
    <ControlsContainer>
      {settings.arm ? (
        <Control
          background="red"
          onClick={() => updateSettings({ ...settings, arm: false })}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="17"
            height="17"
            viewBox="0 0 453.452 453.452"
            fill="#fff"
          >
            <defs />
            <path d="M447.488 360.358l-179.2-314.88c-8.192-14.848-23.552-23.552-41.472-23.552s-32.768 8.704-41.472 23.552l-179.2 314.88c-8.192 14.848-8.192 32.768 0 47.616s23.552 23.552 40.96 23.552h357.888c17.408 0 32.768-8.704 40.96-23.552 9.728-14.848 9.728-32.768 1.536-47.616zm-194.56-3.584h-47.616v-41.472h47.616v41.472zm0-65.536h-47.616V172.454h47.616v118.784z" />
          </svg>
          Disarm
        </Control>
      ) : (
        <Control
          background="green"
          onClick={() => updateSettings({ ...settings, arm: true })}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="17"
            height="17"
            viewBox="0 0 428.16 428.16"
            fill="#fff"
          >
            <defs />
            <path d="M393.8 110.208c-.512-11.264-.512-22.016-.512-32.768 0-8.704-6.656-15.36-15.36-15.36-64 0-112.64-18.432-153.088-57.856-6.144-5.632-15.36-5.632-21.504 0C162.888 43.648 114.248 62.08 50.248 62.08c-8.704 0-15.36 6.656-15.36 15.36 0 10.752 0 21.504-.512 32.768-2.048 107.52-5.12 254.976 174.592 316.928l5.12 1.024 5.12-1.024c179.2-61.952 176.64-208.896 174.592-316.928zM201.8 259.2c-3.072 2.56-6.656 4.096-10.752 4.096h-.512c-4.096 0-8.192-2.048-10.752-5.12l-47.616-52.736 23.04-20.48 37.376 41.472 82.944-78.848 20.992 22.528L201.8 259.2z" />
          </svg>
          Arm
        </Control>
      )}
      <Control as={Link} to="/settings" background="asphalt">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="17"
          height="17"
          viewBox="0 0 422.912 422.912"
          fill="#fff"
        >
          <defs />
          <path d="M410.112 169.472l-29.696-5.12c-3.584-13.824-9.216-27.136-16.384-39.424l17.408-24.576c4.608-6.144 4.096-14.848-1.536-19.968l-37.888-37.888c-5.12-5.632-13.824-6.144-19.968-1.536l-24.576 17.408c-12.288-6.656-25.6-12.288-38.912-15.872L253.44 12.8C252.416 5.12 245.76 0 238.08 0h-53.248c-7.68 0-14.336 5.12-15.36 12.8l-5.12 29.696c-13.824 3.584-27.136 9.216-39.424 16.384l-24.576-17.408c-6.144-4.608-14.848-4.096-19.968 1.536L42.496 80.896c-5.632 5.12-6.144 13.824-1.536 19.968l17.408 24.576c-6.656 12.288-12.288 25.6-15.872 38.912l-29.696 5.12c-7.68 1.024-12.8 7.68-12.8 15.36v53.248c0 7.68 5.12 14.336 12.8 15.36l29.696 5.12c3.584 13.824 9.216 27.136 16.384 39.424L41.472 322.56c-4.608 6.144-4.096 14.848 1.536 19.968l37.888 37.888c5.12 5.632 13.824 6.144 19.968 1.536l24.576-17.408c12.288 6.656 25.6 12.288 38.912 15.872l5.12 29.696c1.024 7.68 7.68 12.8 15.36 12.8h53.248c7.68 0 14.336-5.12 15.36-12.8l5.12-29.696c13.824-3.584 27.136-9.216 39.424-16.384l24.576 17.408c6.144 4.608 14.848 4.096 19.968-1.536l37.888-37.888c5.632-5.12 6.144-13.824 1.536-19.968l-17.408-24.576c6.656-12.288 12.288-25.6 15.872-38.912l29.696-5.12c7.68-1.024 12.8-7.68 12.8-15.36v-53.248c0-7.68-5.12-14.336-12.8-15.36zM211.456 295.936c-46.592 0-84.48-37.888-84.48-84.48s37.888-84.48 84.48-84.48 84.48 37.888 84.48 84.48-37.888 84.48-84.48 84.48z" />
        </svg>
        Settings
      </Control>
    </ControlsContainer>
  );
};

export default React.memo(Controls);
